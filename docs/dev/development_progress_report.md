# AVATAR - é–‹ç™¼é€²åº¦å ±å‘Š

> æ›´æ–°æ—¥æœŸ: 2025-11-02
> é–‹ç™¼ç‹€æ…‹: In Development (Phase 2 - E2E Pipeline å®Œæˆ + é˜²ç¦¦æ©Ÿåˆ¶ä¸Šç·š)
> å®Œæˆåº¦: 82%
> Sprint: 1 (Week 1: æ ¸å¿ƒæµç¨‹é–‹ç™¼ + AI æ•´åˆ + é˜²ç¦¦æ€§è¨­è¨ˆ)

---

## ğŸ“Š ç¸½é«”é€²åº¦æ¦‚è¦½

### ç•¶å‰é‡Œç¨‹ç¢‘
- **Milestone**: MVP æŠ€è¡“è¦æ ¼å®Œæˆ âœ…
- **ä¸‹å€‹é‡Œç¨‹ç¢¼**: Week 1 - æ ¸å¿ƒæµç¨‹æ‰“é€š
- **é è¨ˆä¸Šç·š**: 2025-12-01ï¼ˆ4 é€±ï¼‰

### å¯¦éš›é€²åº¦
```
[================....] 82% (Phase 2 E2E Pipeline å®Œæˆ + é˜²ç¦¦æ©Ÿåˆ¶ä¸Šç·š)

Phase 0: è¦åŠƒ        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% âœ…
Phase 1: ç’°å¢ƒæº–å‚™    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% âœ…
Phase 2: æ ¸å¿ƒé–‹ç™¼    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ---- 82%
Phase 3: æ¸¬è©¦ä¸Šç·š    -------------------- 0%
```

### é—œéµé¢¨éšª
| é¢¨éšª | ç‹€æ…‹ | ç·©è§£æªæ–½ |
|:---|:---|:---|
| VRAM ä¸è¶³å°è‡´ OOM | ğŸŸ¢ ä½ | **å·²é©—è­‰**: å¯¦éš›ä½¿ç”¨ 11.12GB (46.3%)ï¼Œé ç•™ 53.7% ç·©è¡ |
| HQ-TTS è¼‰å…¥å»¶é² | ğŸŸ¡ ä¸­ | é ç†±æ©Ÿåˆ¶ + é€²åº¦æç¤º |
| é–‹ç™¼æ™‚ç¨‹ç·Šè¿« | ğŸŸ  é«˜ | æ¡ç”¨ Linus å¼ç²¾ç°¡æ¶æ§‹ |

---

## ğŸ“ˆ é–‹ç™¼é€²åº¦æ™‚é–“è»¸ï¼ˆGanttï¼‰

```mermaid
gantt
    title AVATAR MVP é–‹ç™¼è¨ˆç•«
    dateFormat YYYY-MM-DD
    section Phase 0
    æŠ€è¡“è¦æ ¼æ’°å¯«          :done,    spec, 2025-11-01, 1d
    ç’°å¢ƒæº–å‚™              :         env,  2025-11-02, 1d

    section Week 1
    FastAPI + WebSocket   :         w1t1, 2025-11-03, 2d
    Whisper STT æ•´åˆ      :         w1t2, 2025-11-03, 2d
    vLLM æ•´åˆ             :         w1t3, 2025-11-05, 2d
    F5-TTS å¿«é€Ÿåˆæˆ       :         w1t4, 2025-11-07, 2d
    SQLite è³‡æ–™å±¤         :         w1t5, 2025-11-05, 2d

    section Week 2
    è²ç´‹ä¸Šå‚³èˆ‡ç®¡ç†        :         w2t1, 2025-11-10, 3d
    CosyVoice HQ-TTS      :         w2t2, 2025-11-10, 3d
    å‰ç«¯èŠå¤©ä»‹é¢          :         w2t3, 2025-11-13, 3d

    section Week 3
    å°è©±æ­·å²åŠŸèƒ½          :         w3t1, 2025-11-17, 2d
    éŒ¯èª¤è™•ç†èˆ‡é‡é€£        :         w3t2, 2025-11-19, 2d
    æ€§èƒ½å„ªåŒ–              :         w3t3, 2025-11-21, 2d

    section Week 4
    æ•´åˆæ¸¬è©¦              :crit,    w4t1, 2025-11-24, 2d
    å£“åŠ›æ¸¬è©¦              :crit,    w4t2, 2025-11-26, 2d
    éƒ¨ç½²è…³æœ¬              :         w4t3, 2025-11-28, 1d
    ä¸Šç·šæº–å‚™              :crit,    w4t4, 2025-11-29, 2d
```

---

## âœ… åŠŸèƒ½é–‹ç™¼ç‹€æ…‹

### å·²å®Œæˆï¼ˆWeek 0 - Phase 1ï¼‰
- âœ… MVP æŠ€è¡“è¦æ ¼æ–‡æª”
- âœ… é–‹ç™¼é€²åº¦å ±å‘Šæ¨¡æ¿
- âœ… ç›®éŒ„çµæ§‹è¦åŠƒ
- âœ… TaskMaster å°ˆæ¡ˆåˆå§‹åŒ–
- âœ… GitHub å€‰åº«å»ºç«‹ (https://github.com/Zenobia000/AI-assistant_bot)
- âœ… Poetry è™›æ“¬ç’°å¢ƒé…ç½®
- âœ… åŸºç¤ä¾è³´å®‰è£ (FastAPI, Uvicorn, WebSockets, etc.)
- âœ… PyTorch CUDA 12.1 å®‰è£ (torch 2.3.1+cu121) **âš ï¸ é™ç´šä»¥ç›¸å®¹ CosyVoice3**
- âœ… vLLM 0.5.3 å®‰è£ **âš ï¸ é™ç´šä»¥ç›¸å®¹ torch 2.3.1**
- âœ… F5-TTS 1.1.9 å®‰è£ (å¿«é€Ÿ TTS ç³»çµ±)
- âœ… CosyVoice3 ä¾è³´å®‰è£ (é«˜è³ª TTS ç³»çµ±)
- âœ… flash-attn 2.5.8 ç·¨è­¯å®‰è£ (10-15% æ•ˆèƒ½æå‡)
- âœ… ç’°å¢ƒé©—è­‰é€šé (RTX 3090 24GB æª¢æ¸¬æˆåŠŸ)
- âœ… SQLite è³‡æ–™åº« schema å»ºç«‹ (conversations + voice_profiles)
- âœ… WAL æ¨¡å¼å•Ÿç”¨ï¼ˆæå‡ä¸¦ç™¼æ€§èƒ½ï¼‰
- âœ… è³‡æ–™åº«åˆå§‹åŒ–è…³æœ¬ (scripts/init_database.py)
- âœ… Git èˆ‡ GitHub é ç«¯å€‰åº«åˆå§‹åŒ–

### å·²å®Œæˆï¼ˆWeek 1 - Phase 2, Tasks 7-8-9-10-11-12ï¼‰
- âœ… FastAPI ä¸»æ‡‰ç”¨ç¨‹å¼æ¶æ§‹ (src/avatar/main.py)
- âœ… é…ç½®ç®¡ç†ç³»çµ± (src/avatar/core/config.py)
- âœ… WebSocket ç«¯é»èˆ‡æœƒè©±ç®¡ç† (src/avatar/api/websocket.py)
- âœ… WebSocket è¨Šæ¯å”è­°å®šç¾© (src/avatar/models/messages.py)
- âœ… è³‡æ–™åº«æ“ä½œå±¤ (src/avatar/services/database.py)
- âœ… å°è©±æŒä¹…åŒ–åŠŸèƒ½ï¼ˆconversations table å®Œæ•´ CRUDï¼‰
- âœ… è²ç´‹ç®¡ç†åŠŸèƒ½ï¼ˆvoice_profiles table å®Œæ•´ CRUDï¼‰
- âœ… ä¼ºæœå™¨å•Ÿå‹•è…³æœ¬ (run_server.py, run_dev.py)

**âœ¨ æ–°å®Œæˆï¼ˆ2025-11-02ï¼‰**:
- âœ… **Task 9**: Whisper STT æœå‹™ (src/avatar/services/stt.py)
  - CPU æ¨ç† (int8 é‡åŒ–) - é¿å… VRAM ç«¶çˆ­
  - ç•°æ­¥è½‰éŒ„ API with VAD éæ¿¾
  - è‡ªå‹•èªè¨€åµæ¸¬
  - Singleton æ¨¡å¼è³‡æºç®¡ç†

- âœ… **Task 10**: vLLM æ¨ç†æœå‹™ (src/avatar/services/llm.py)
  - GPU åŠ é€Ÿæ¨ç† (50% VRAM é ç•™)
  - ä¸²æµéŸ¿æ‡‰æ”¯æ´ (ä½ TTFT)
  - Qwen2.5-Instruct èŠå¤©ç¯„æœ¬
  - éä¸²æµ/ä¸²æµé›™æ¨¡å¼

- âœ… **Task 11**: F5-TTS Fast æ¨¡å¼ (src/avatar/services/tts.py)
  - GPU åŠ é€Ÿåˆæˆ
  - è²éŸ³å…‹éš†æ”¯æ´
  - å¿«é€Ÿåˆæˆæ¨¡å¼
  - Voice profile ç®¡ç†

**ğŸ§ Linus å¼ç¨‹å¼ç¢¼å¯©æŸ¥èˆ‡ä¿®å¾©**:
- âœ… **P0 (Critical)**: ä¿®å¾© Singleton ç«¶çˆ­æ¢ä»¶
  - æ‰€æœ‰æœå‹™æ·»åŠ  asyncio.Lock ä¿è­·
  - Double-Checked Locking æ¨¡å¼
  - 10x ä¸¦ç™¼æ¸¬è©¦é©—è­‰é€šé
  - é˜²æ­¢ VRAM çˆ†ç‚¸ (24GB â†’ 80GB+ é¢¨éšªæ¶ˆé™¤)

- âœ… **P1 (High)**: ç¨‹å¼ç¢¼å“è³ªæ”¹é€²
  - TTSService: åˆ†é›¢æª”æ¡ˆç®¡ç†èˆ‡æ¥­å‹™é‚è¼¯
  - LLMService: DRY åŸå‰‡æ¶ˆé™¤é‡è¤‡ç¨‹å¼ç¢¼
  - STTService: åˆªé™¤ä¸å¿…è¦çš„åŒ…è£å™¨å‡½å¼

- âœ… **P2 (Medium)**: TTSService è¨˜æ†¶é«”å„ªåŒ–
  - ç§»é™¤å‡½å¼å¼•ç”¨å„²å­˜ (æ¸›å°‘ 3 å€‹å¯¦ä¾‹è®Šæ•¸)
  - æ¨¡çµ„ç´šå·¥å…·å‡½å¼ç›´æ¥å°å…¥ä½¿ç”¨
  - æ˜ç¢ºå€åˆ†ã€Œç‹€æ…‹ã€èˆ‡ã€Œå·¥å…·ã€

**âš ï¸ ç‰ˆæœ¬ç›¸å®¹æ€§èª¿æ•´**:
- PyTorch é™ç´šè‡³ 2.3.1+cu121 ä»¥ç›¸å®¹ CosyVoice3 (åŸ 2.8.0)
- vLLM é™ç´šè‡³ 0.5.3 ä»¥ç›¸å®¹ torch 2.3.1 (åŸ 0.11.0)
- flash-attn å¾æºç¢¼ç·¨è­¯ 2.5.8 ç‰ˆæœ¬

**ğŸ”¬ ç’°å¢ƒé©—è­‰èˆ‡ TTSService ä¿®å¾© (2025-11-02)**:
- âœ… **ç’°å¢ƒé©—è­‰æ¸¬è©¦è…³æœ¬**: `scripts/test_model_loading.py` (301 è¡Œ)
  - å››éšæ®µæ¸¬è©¦: STT â†’ LLM â†’ TTS â†’ ä¸¦ç™¼è¼‰å…¥
  - è‡ªå‹•åŒ– VRAM ç›£æ§èˆ‡å ±å‘Š
  - æ¸…ç†èˆ‡è³‡æºé‡‹æ”¾æ©Ÿåˆ¶

- âœ… **æ¨¡å‹è¼‰å…¥é©—è­‰çµæœ**:
  ```
  Test 1: STTService  âœ… PASSED - Whisper base (CPU int8) - 0 GB VRAM
  Test 2: LLMService  âœ… PASSED - vLLM Qwen2.5-7B-AWQ - 10.44 GB VRAM (43.5%)
  Test 3: TTSService  âœ… PASSED - F5-TTS (GPU) - +0.68 GB VRAM
  Test 4: Concurrent  âœ… PASSED - Total 11.12 GB VRAM (46.3%)
  ```

- âœ… **TTSService F5TTS API é·ç§»** (Critical Fix):
  - **å•é¡Œ**: ä½¿ç”¨ä½éš `load_model()` API ç¼ºå°‘ `ckpt_path` åƒæ•¸å°è‡´å¤±æ•—
  - **è§£æ±ºæ–¹æ¡ˆ**: åˆ‡æ›è‡³é«˜éš `F5TTS` class (å¾ `f5_tts.api` å°å…¥)
  - **å„ªå‹¢**: è‡ªå‹•å¾ HuggingFace ä¸‹è¼‰é è¨“ç·´æ¨¡å‹ï¼Œç°¡åŒ–ç¨‹å¼ç¢¼ 40 è¡Œ
  - **ä¿®æ”¹æª”æ¡ˆ**: `src/avatar/services/tts.py` (357 â†’ ~295 è¡Œ)

- âœ… **VRAM åˆ†é…ç­–ç•¥é©—è­‰**:
  - **é æœŸ**: STT (0GB) + LLM (12GB) + TTS (4GB) = ~16GB
  - **å¯¦éš›**: 11.12 GB (ç¯€çœ 30% å¾—ç›Šæ–¼ AWQ é‡åŒ–)
  - **ç·©è¡**: 12.88 GB (53.7% å‰©é¤˜)
  - **ä¸¦ç™¼èƒ½åŠ›**: å¯ç©©å®šæ”¯æ´ 3-5 å€‹ä¸¦ç™¼ä½¿ç”¨è€…
  - **é¢¨éšªç‹€æ…‹**: VRAM ä¸è¶³é¢¨éšªå¾ ğŸŸ¡ ä¸­ é™ç‚º ğŸŸ¢ ä½

**ğŸš€ Task 13 P0 æ ¸å¿ƒæ•´åˆå®Œæˆ (2025-11-02)**:
- âœ… **AI æœå‹™æ•´åˆåˆ° WebSocket** (`src/avatar/api/websocket.py` +320 è¡Œ):
  - **STTService æ•´åˆ**: `_run_stt()` æ–¹æ³•ä½¿ç”¨ Whisper (CPU, auto language detection, VAD filtering)
  - **LLMService æ•´åˆ**: `_run_llm()` æ–¹æ³•ä½¿ç”¨ vLLM (GPU, Qwen2.5-Instruct chat template)
  - **TTSService æ•´åˆ**: `_run_tts()` æ–¹æ³•æ”¯æ´é›™æ¨¡å¼:
    - Mode 1: Voice profile (pre-registered)
    - Mode 2: Self-cloning (uses user's audio as reference)

- âœ… **VRAM ç›£æ§èˆ‡ä¸¦ç™¼é™æµ** (`src/avatar/core/session_manager.py` +189 è¡Œæ–°æª”æ¡ˆ):
  - **SessionManager** class å¯¦ä½œ:
    - ä¸¦ç™¼é™åˆ¶: 5 sessions max (asyncio.Semaphore)
    - VRAM ç›£æ§: 90% threshold è‡ªå‹•æ‹’çµ•æ–°é€£ç·š
    - Fail-fast: 1s timeout (ä¸ç­‰å¾…)
    - é˜²æ­¢ OOM éŒ¯èª¤
  - **WebSocket æ•´åˆ**:
    - `acquire_session()` åœ¨æ¥å—é€£ç·šå‰æª¢æŸ¥ VRAM
    - `release_session()` åœ¨ finally å€å¡Šé‡‹æ”¾æ§½ä½
    - ä¼ºæœå™¨æ»¿è¼‰æ™‚å›å‚³ "SERVER_FULL" éŒ¯èª¤

- âœ… **Linus å¼è¨­è¨ˆå“²å­¸æ‡‰ç”¨**:
  - ç°¡å–®è³‡æ–™çµæ§‹ï¼ˆno complex queueï¼‰
  - ç„¡ç‰¹æ®Šæƒ…æ³ï¼ˆfail fast when fullï¼‰
  - å–®ä¸€è·è²¬ï¼ˆSessionManager åªåšä¸€ä»¶äº‹ï¼‰
  - ç„¡éæ—©å„ªåŒ–

**è®Šæ›´çµ±è¨ˆ**:
- `websocket.py`: 439 è¡Œ (+124 è¡Œå¯¦éš› AI æ•´åˆ)
- `session_manager.py`: 189 è¡Œï¼ˆæ–°æª”æ¡ˆï¼‰
- **ç¸½è¨ˆ**: +509 è¡Œç¨‹å¼ç¢¼

**Git Commit**: `06f8562` âœ…

**ğŸ¯ Task 13 P0 Part 2-3: é˜²ç¦¦æ©Ÿåˆ¶èˆ‡æ•ˆèƒ½å„ªåŒ– (2025-11-02)**:

- âœ… **éŸ³æª”æ ¼å¼è½‰æ›é‚è¼¯** (`src/avatar/core/audio_utils.py` +196 è¡Œæ–°æª”æ¡ˆ):
  - **convert_to_wav()**: ä½¿ç”¨ torchaudio è½‰æ›ä»»æ„æ ¼å¼ â†’ WAV 16kHz mono
  - **convert_to_wav_async()**: ç•°æ­¥åŒ…è£å™¨ (run_in_executor)
  - **validate_audio_for_whisper()**: Whisper æ ¼å¼é©—è­‰
  - **WebSocket æ•´åˆ**: `_save_audio()` è‡ªå‹•è½‰æ› WebM/Opus â†’ WAV
  - **Linus å“²å­¸**: ä½¿ç”¨å·²æœ‰çš„ torchaudioï¼Œä¸å¢åŠ æ–°ä¾è³´

- âœ… **Buffer é™åˆ¶èˆ‡è¶…æ™‚æ©Ÿåˆ¶** (`websocket.py` +67 è¡Œ):
  - **ä¸‰å±¤é˜²ç¦¦**:
    - MAX_BUFFER_SIZE: 10MB (~2 åˆ†é˜éŸ³æª”)
    - MAX_CHUNK_COUNT: 1000 chunks
    - BUFFER_TIMEOUT: 60 seconds
  - **å¯¦ä½œ**:
    - `add_audio_chunk()` æ¯æ¬¡æª¢æŸ¥ä¸‰å€‹é™åˆ¶
    - è¶…é™æ™‚æ‹‹å‡º RuntimeError
    - WebSocket æ•æ‰éŒ¯èª¤ä¸¦æ¸…ç©º bufferï¼ˆå…è¨±é‡è©¦ï¼‰
  - **é˜²æ­¢**: è¨˜æ†¶é«”æ´©æ¼ã€DoS æ”»æ“Šã€æƒ¡æ„è¶…å¤§éŸ³æª”

- âœ… **LLM ä¸²æµå„ªåŒ–** (`llm.py` +51 è¡Œ, `websocket.py` +27 è¡Œ):
  - **LLMService æ–°å¢**:
    - `_format_chat_messages()`: DRY helper method
    - `chat_stream()`: AsyncIterator ä¸²æµå›æ‡‰
  - **WebSocket æ•´åˆ**:
    - `_run_llm()` ä½¿ç”¨ `chat_stream()`
    - å³æ™‚ç™¼é€ä¸­é–“ chunks (is_final=False)
    - æœ€çµ‚è¨Šæ¯ç¢ºèªå®Œæ•´å›æ‡‰ (is_final=True)
  - **æ•ˆèƒ½æå‡**:
    - TTFT: ~800ms â†’ ~200-300ms (é™ä½ 60-70%)
    - ä½¿ç”¨è€…é«”é©—: å³æ™‚çœ‹åˆ° LLM ç”Ÿæˆ

**è®Šæ›´çµ±è¨ˆ (æœ¬æ¬¡ session)**:
- `audio_utils.py`: 196 è¡Œï¼ˆæ–°æª”æ¡ˆï¼‰
- `websocket.py`: +112 è¡Œï¼ˆformat conversion + buffer limitsï¼‰
- `llm.py`: +51 è¡Œï¼ˆstreaming supportï¼‰
- **ç¸½è¨ˆ**: +359 è¡Œç¨‹å¼ç¢¼

**Git Commits**: `b88f140`, `7e4c449` âœ…

### é–‹ç™¼ä¸­ï¼ˆWeek 1 - Phase 2, Task 13ï¼‰
- ğŸ”„ **Task 13 è¿‘ä¹å®Œæˆ** (89%): WebSocket E2E æ•´åˆæ¸¬è©¦
  - âœ… P0 æ ¸å¿ƒä»»å‹™å®Œæˆï¼ˆ8/9ï¼‰:
    - âœ… AI æœå‹™æ•´åˆï¼ˆSTT/LLM/TTSï¼‰
    - âœ… VRAM ç›£æ§èˆ‡ä¸¦ç™¼é™æµ
    - âœ… SessionManager å¯¦ä½œèˆ‡æ•´åˆ
    - âœ… éŸ³æª”æ ¼å¼è½‰æ›ï¼ˆWebM/Opus â†’ WAV 16kHzï¼‰
    - âœ… Buffer å¤§å°é™åˆ¶èˆ‡è¶…æ™‚æ©Ÿåˆ¶
    - âœ… LLM ä¸²æµç‰ˆæœ¬ï¼ˆé™ä½ TTFT 60-70%ï¼‰
  - â³ P0 å¾…å®Œæˆï¼ˆ1/9ï¼‰:
    - â¸ï¸ E2E åŠŸèƒ½æ¸¬è©¦èˆ‡æ•ˆèƒ½æ¸¬é‡
  - ğŸ›¡ï¸ é§•é§›å“¡å¯©æŸ¥æª¢æŸ¥é»ï¼ˆå³å°‡é€²å…¥ï¼‰

### å¾…è¾¦ï¼ˆWeek 1-4ï¼‰

#### Week 1: æ ¸å¿ƒæµç¨‹æ‰“é€š
- [x] **å¾Œç«¯åŸºç¤** âœ…
  - [x] FastAPI å°ˆæ¡ˆåˆå§‹åŒ– âœ…
  - [x] WebSocket é€£æ¥è™•ç† âœ…
  - [x] SQLite è³‡æ–™åº«åˆå§‹åŒ– âœ…
  - [x] éŸ³æª”å­˜å„²ç›®éŒ„å»ºç«‹ âœ…

- [ ] **AI æ¨¡å‹æ•´åˆ**
  - [ ] Whisper STT æœå‹™å°è£
  - [ ] vLLM æœå‹™èª¿ç”¨
  - [ ] F5-TTS å¿«é€Ÿåˆæˆ

- [ ] **é©—æ”¶æ¨™æº–**
  - [ ] èªéŸ³è¼¸å…¥ â†’ è½‰éŒ„ â†’ LLM â†’ å¿«é€Ÿ TTS æµç¨‹å¯è·‘é€š
  - [ ] E2E å»¶é² < 5sï¼ˆåˆç‰ˆï¼‰

#### Week 2: è²ç´‹èˆ‡é«˜è³ª TTS
- [ ] **è²ç´‹ç®¡ç†**
  - [ ] è²éŸ³ä¸Šå‚³ API
  - [ ] Embedding æå–
  - [ ] è²ç´‹åˆ—è¡¨èˆ‡åˆªé™¤

- [ ] **é«˜è³ª TTS**
  - [ ] CosyVoice3 æ•´åˆ
  - [ ] æŒ‰éœ€è¼‰å…¥æ©Ÿåˆ¶
  - [ ] å¿«/ç¾é›™æª”åˆ‡æ›

- [ ] **å‰ç«¯é–‹ç™¼**
  - [ ] èŠå¤©ä»‹é¢ï¼ˆReactï¼‰
  - [ ] éº¥å…‹é¢¨éŒ„éŸ³çµ„ä»¶
  - [ ] éŸ³é »æ’­æ”¾å™¨

- [ ] **é©—æ”¶æ¨™æº–**
  - [ ] è²éŸ³å…‹éš†åŠŸèƒ½å¯ç”¨
  - [ ] å‰ç«¯å¯æ­£å¸¸å°è©±

#### Week 3: å®Œå–„åŠŸèƒ½
- [ ] **åŠŸèƒ½è£œå®Œ**
  - [ ] å°è©±æ­·å²æŸ¥è©¢
  - [ ] éŸ³é »é‡æ’­
  - [ ] æœƒè©±ç®¡ç†

- [ ] **éŒ¯èª¤è™•ç†**
  - [ ] WebSocket æ–·ç·šé‡é€£
  - [ ] VRAM ä¸è¶³é™ç´š
  - [ ] éŒ¯èª¤æ—¥èªŒè¨˜éŒ„

- [ ] **æ€§èƒ½å„ªåŒ–**
  - [ ] VRAM ä½¿ç”¨ç›£æ§
  - [ ] ä¸¦ç™¼é™æµ
  - [ ] éŸ³æª”å£“ç¸®

- [ ] **é©—æ”¶æ¨™æº–**
  - [ ] E2E å»¶é² P95 < 3.5s
  - [ ] ç„¡æ˜é¡¯ bug

#### Week 4: æ¸¬è©¦èˆ‡ä¸Šç·š
- [ ] **æ¸¬è©¦**
  - [ ] å–®å…ƒæ¸¬è©¦ï¼ˆæ ¸å¿ƒé‚è¼¯ï¼‰
  - [ ] æ•´åˆæ¸¬è©¦ï¼ˆE2E æµç¨‹ï¼‰
  - [ ] å£“åŠ›æ¸¬è©¦ï¼ˆ5 ä¸¦ç™¼ 2 å°æ™‚ï¼‰

- [ ] **éƒ¨ç½²**
  - [ ] éƒ¨ç½²è…³æœ¬
  - [ ] ç’°å¢ƒé…ç½®æ–‡æª”
  - [ ] å‚™ä»½è…³æœ¬

- [ ] **é©—æ”¶æ¨™æº–**
  - [ ] é€šé MVP ä¸Šç·šæª¢æŸ¥æ¸…å–®
  - [ ] KPI é”æ¨™

---

## ğŸ–¥ï¸ å‰ç«¯é–‹ç™¼é€²åº¦

### é é¢é–‹ç™¼ç‹€æ…‹

| é é¢ | è·¯ç”± | ç‹€æ…‹ | å®Œæˆåº¦ | å‚™è¨» |
|:---|:---|:---|:---|:---|
| èŠå¤©ä»‹é¢ | `/chat` | ğŸ“ è¨­è¨ˆä¸­ | 0% | Week 2 é–‹å§‹ |
| è²ç´‹ç®¡ç† | `/voice-profiles` | ğŸ“ è¨­è¨ˆä¸­ | 0% | Week 2 é–‹å§‹ |
| å°è©±æ­·å² | `/history` | ğŸ“ è¦åŠƒä¸­ | 0% | Week 3 é–‹å§‹ |

### æ ¸å¿ƒçµ„ä»¶ç‹€æ…‹

| çµ„ä»¶ | ä¾è³´ API | ç‹€æ…‹ | å®Œæˆåº¦ |
|:---|:---|:---|:---|
| `ChatInterface` | `WS /ws/chat` | ğŸ“ è¨­è¨ˆä¸­ | 0% |
| `MicrophoneButton` | WebRTC API | ğŸ“ è¨­è¨ˆä¸­ | 0% |
| `AudioPlayer` | HTML5 Audio | ğŸ“ è¨­è¨ˆä¸­ | 0% |
| `ProfileList` | `GET /api/voice-profiles` | ğŸ“ è¦åŠƒä¸­ | 0% |
| `UploadDialog` | `POST /api/voice-profile` | ğŸ“ è¦åŠƒä¸­ | 0% |

---

## ğŸ“Š é—œéµæŠ€è¡“æŒ‡æ¨™

| æŒ‡æ¨™ | ç•¶å‰å€¼ | ç›®æ¨™å€¼ | ç‹€æ…‹ | å‚™è¨» |
|:---|:---|:---|:---|:---|
| **E2E å»¶é²ï¼ˆ50å­—ï¼‰** | N/A | P95 â‰¤ 3.5s | â³ å¾…æ¸¬ | Task 13 é–‹å§‹æ¸¬é‡ |
| **LLM TTFT** | N/A | P95 â‰¤ 800ms | â³ å¾…æ¸¬ | vLLM å…§å»ºæŒ‡æ¨™ |
| **Fast TTS å»¶é²** | N/A | P50 â‰¤ 1.5s | â³ å¾…æ¸¬ | Task 13 é–‹å§‹æ¸¬é‡ |
| **VRAM ä½¿ç”¨ç‡** | **11.12 GB (46.3%)** | < 90% | âœ… **å„ªæ–¼ç›®æ¨™** | å¯¦æ¸¬: STT(0GB) + LLM(10.44GB) + TTS(0.68GB) |
| **ä¸¦ç™¼æœƒè©±æ•¸** | **é ä¼° 3-5** | 3-5 ç©©å®š | ğŸŸ¢ å¯é”æˆ | åŸºæ–¼ 53.7% VRAM ç·©è¡ä¼°ç®— |
| **éŒ¯èª¤ç‡** | N/A | < 1% | â³ å¾…æ¸¬ | æ—¥èªŒçµ±è¨ˆ |

### æ€§èƒ½æ¸¬è©¦è¨ˆç•«

```python
# Week 4 å£“åŠ›æ¸¬è©¦è…³æœ¬
async def stress_test():
    """
    æ¸¬è©¦å ´æ™¯:
    1. 5 å€‹ä¸¦ç™¼ WebSocket é€£æ¥
    2. æ¯å€‹é€£æ¥æ¯ 10 ç§’ç™¼é€ä¸€æ¬¡èªéŸ³
    3. æŒçºŒé‹è¡Œ 2 å°æ™‚
    4. è¨˜éŒ„æ‰€æœ‰å»¶é²èˆ‡éŒ¯èª¤
    """
    # TODO: å¯¦ä½œ
```

---

## ğŸ¯ ä¸‹éšæ®µé–‹ç™¼é‡é»

### Week 1 å„ªå…ˆç´šï¼ˆP0ï¼‰
1. **ç’°å¢ƒæ­å»º** - ç¢ºä¿æ‰€æœ‰ä¾è³´å¯ç”¨
2. **æ ¸å¿ƒæµç¨‹** - èªéŸ³ â†’ LLM â†’ TTS æ‰“é€š
3. **æ•¸æ“šæŒä¹…åŒ–** - SQLite åŸºæœ¬æ“ä½œ

### éœ€è¦é¡å¤–è³‡æº
- âŒ ç„¡é¡å¤–éœ€æ±‚ï¼ˆå–®äººé–‹ç™¼ï¼‰

### é æœŸäº¤ä»˜ç‰©
- [ ] å¯é‹è¡Œçš„ FastAPI æœå‹™
- [ ] åŸºæœ¬çš„ WebSocket å°è©±åŠŸèƒ½
- [ ] SQLite è³‡æ–™åº«åˆå§‹åŒ–è…³æœ¬

---

## âš ï¸ æŠ€è¡“å‚µå‹™èˆ‡é¢¨éšª

### ç•¶å‰æŠ€è¡“å‚µå‹™
- ç„¡ï¼ˆå°ˆæ¡ˆå‰›å•Ÿå‹•ï¼‰

### æ½›åœ¨æŠ€è¡“å‚µå‹™ï¼ˆéœ€åœ¨ Week 3-4 è™•ç†ï¼‰
1. **æ¸¬è©¦è¦†è“‹ç‡ä¸è¶³**
   - é¢¨éšªï¼šåŠŸèƒ½å¯ç”¨ä½†ç©©å®šæ€§æœªé©—è­‰
   - è¨ˆç•«ï¼šWeek 4 è£œå……æ ¸å¿ƒé‚è¼¯æ¸¬è©¦

2. **éŒ¯èª¤è™•ç†ä¸å®Œå–„**
   - é¢¨éšªï¼šé‚Šç•Œæƒ…æ³æœªè¦†è“‹
   - è¨ˆç•«ï¼šWeek 3 è£œå……éŒ¯èª¤è™•ç†

3. **ç›£æ§ä¸è¶³**
   - é¢¨éšªï¼šç”Ÿç”¢å•é¡Œé›£ä»¥å®šä½
   - è¨ˆç•«ï¼šWeek 3 åŠ å…¥çµæ§‹åŒ–æ—¥èªŒ

### å‡ç´šè©•ä¼°æ¢ä»¶

è‹¥å‡ºç¾ä»¥ä¸‹æƒ…æ³ï¼Œéœ€å‡ç´šè‡³ã€Œå®Œæ•´æµç¨‹ã€ï¼š
- [ ] éœ€è¦å¤šç”¨æˆ¶ç³»çµ±ï¼ˆèº«ä»½é©—è­‰ï¼‰
- [ ] ä¸¦ç™¼éœ€æ±‚ > 10 æœƒè©±
- [ ] éœ€è¦å¼•å…¥ PostgreSQL/Redis
- [ ] éœ€è¦è·¨åœ˜éšŠå”ä½œ

---

## ğŸ“ˆ æˆåŠŸæŒ‡æ¨™è¿½è¹¤ï¼ˆKPIsï¼‰

### æ ¸å¿ƒ KPI

| KPI | ç›®æ¨™ | ç•¶å‰å€¼ | é”æˆç‡ | è¶¨å‹¢ | æœ€å¾Œæ›´æ–° |
|:---|:---|:---|:---|:---|:---|
| **E2E å»¶é²** | P95 â‰¤ 3.5s | N/A | 0% | - | Week 1 å¾Œ |
| **ç³»çµ±ç©©å®šæ€§** | 2h 5ä¸¦ç™¼ç„¡OOM | N/A | 0% | - | Week 4 æ¸¬è©¦ |
| **éŸ³è³ªæ»¿æ„åº¦** | ä¸»è§€è©•åˆ† â‰¥ 7/10 | N/A | 0% | - | Week 4 æ¸¬è©¦ |

### æ¬¡è¦æŒ‡æ¨™

| æŒ‡æ¨™ | ç›®æ¨™ | ç‹€æ…‹ |
|:---|:---|:---|
| ä»£ç¢¼é‡ | < 2000 è¡Œ | â³ å¾…çµ±è¨ˆ |
| API ç«¯é»æ•¸ | â‰¤ 10 å€‹ | âœ… ç¬¦åˆè¦åŠƒ |
| å¤–éƒ¨ä¾è³´ | â‰¤ 5 å€‹ | âœ… ç¬¦åˆè¦åŠƒ |

---

## ğŸ”„ æ¯é€±æ›´æ–°æª¢æŸ¥æ¸…å–®

### Week 1 æ›´æ–°é …ç›®
- [ ] æ›´æ–°ã€ŒåŠŸèƒ½é–‹ç™¼ç‹€æ…‹ã€
- [ ] æ›´æ–°ã€Œé—œéµæŠ€è¡“æŒ‡æ¨™ã€ï¼ˆé¦–æ¬¡æ¸¬é‡ï¼‰
- [ ] è¨˜éŒ„é‡åˆ°çš„å•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ
- [ ] è©•ä¼°æ˜¯å¦éœ€è¦èª¿æ•´æ™‚ç¨‹

### Week 2-4 æ›´æ–°é …ç›®
- [ ] æ›´æ–°é€²åº¦ç™¾åˆ†æ¯”
- [ ] æ›´æ–° Gantt åœ–ï¼ˆå¦‚æœ‰å»¶é²ï¼‰
- [ ] è¨˜éŒ„æ€§èƒ½æ¸¬è©¦çµæœ
- [ ] æ›´æ–°æŠ€è¡“å‚µå‹™æ¸…å–®

---

## ğŸ“ è®Šæ›´æ—¥èªŒ

| æ—¥æœŸ | ç‰ˆæœ¬ | è®Šæ›´å…§å®¹ | ä½œè€… |
|:---|:---|:---|:---|
| 2025-11-01 | 1.0.0 | åˆç‰ˆå®Œæˆï¼ˆè¦åŠƒéšæ®µï¼‰ | Lead Engineer |
| 2025-11-01 | 1.1.0 | Phase 1 Task 2 å®Œæˆï¼šPoetry ç’°å¢ƒé…ç½®èˆ‡ PyTorch å®‰è£ | Claude Code + TaskMaster |
| 2025-11-01 | 1.2.0 | Phase 1 Tasks 3-4 å®Œæˆï¼šSQLite schema å»ºç«‹ï¼ŒAI æ¨¡å‹å»¶å¾Œ | Claude Code + TaskMaster |
| 2025-11-01 | 1.3.0 | Phase 2 Tasks 7-8-12 å®Œæˆï¼šFastAPI + WebSocket + Database å±¤ | Claude Code + TaskMaster |
| 2025-11-02 | 1.4.0 | Phase 1 Tasks 2-3-5 æ›´æ–°ï¼šTTS ç³»çµ±å®‰è£ (F5-TTS + CosyVoice3), ç‰ˆæœ¬é™ç´š, flash-attn ç·¨è­¯ | Claude Code + TaskMaster |
| 2025-11-02 | 1.5.0 | Phase 2 Tasks 9-10-11 å®Œæˆï¼šSTT/LLM/TTS ä¸‰å¤§ AI æœå‹™å±¤å®Œæˆ + Linus å¼ç¨‹å¼ç¢¼å¯©æŸ¥èˆ‡ä¿®å¾© (P0/P1/P2) | Claude Code + TaskMaster |
| 2025-11-02 | 1.6.0 | ç’°å¢ƒé©—è­‰å®Œæˆï¼šæ¨¡å‹è¼‰å…¥æ¸¬è©¦é€šé + TTSService F5TTS API é·ç§» + VRAM ç­–ç•¥é©—è­‰ (å¯¦éš› 11.12GB vs é æœŸ 16GB, ç¯€çœ 30%) | Claude Code + TaskMaster |
| 2025-11-02 | 1.7.0 | Task 13 P0 Part 1 å®Œæˆï¼šAI æœå‹™æ•´åˆ (STT/LLM/TTS) + VRAM ç›£æ§èˆ‡ä¸¦ç™¼é™æµ (SessionManager) + Linus å¼æ¶æ§‹å¯©æŸ¥ | Claude Code + TaskMaster |
| 2025-11-02 | 1.8.0 | Task 13 P0 Part 2 å®Œæˆï¼šéŸ³æª”æ ¼å¼è½‰æ› (torchaudio) + Buffer é™åˆ¶èˆ‡è¶…æ™‚æ©Ÿåˆ¶ (é˜²æ­¢ DoS/è¨˜æ†¶é«”æ´©æ¼) | Claude Code + TaskMaster |
| 2025-11-02 | 1.9.0 | Task 13 P0 Part 3 å®Œæˆï¼šLLM ä¸²æµå„ªåŒ– (TTFT é™ä½ 60-70%) + å³æ™‚å›æ‡‰é«”é©—æå‡ | Claude Code + TaskMaster |

---

## é™„éŒ„ï¼šå¿«é€Ÿçµ±è¨ˆ

```bash
# ä»£ç¢¼çµ±è¨ˆï¼ˆé è¨ˆï¼‰
Lines of Code:     ~1500-2000
Files:             ~20
API Endpoints:     8-10
Database Tables:   2
Test Coverage:     >70% (æ ¸å¿ƒé‚è¼¯)

# æ™‚ç¨‹çµ±è¨ˆ
Total Duration:    4 weeks
Sprints:          4
Story Points:      ~40 (ä¼°ç®—)
```

---

**ä¸‹æ¬¡æ›´æ–°**: 2025-11-08ï¼ˆWeek 1 çµæŸï¼‰
